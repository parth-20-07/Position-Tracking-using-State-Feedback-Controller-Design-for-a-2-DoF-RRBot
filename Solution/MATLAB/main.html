<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2023a"><title>Two-Link Planar Robot Manipulator with Distributed Mass</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 0 10px 0; }
.S2 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Two-Link Planar Robot Manipulator with Distributed Mass</span></h1><h2  class = 'S1'><span>Clear all data</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >clc;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >clear </span><span style="color: rgb(167, 9, 245);">all</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >close </span><span style="color: rgb(167, 9, 245);">all</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >clf; </span><span style="color: rgb(0, 128, 19);">%Clear all figures</span></span></div></div></div><h2  class = 'S5'><span>Basic Definition</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >bar_mass = [1; 1]; </span><span style="color: rgb(0, 128, 19);">% mass of bar in kg</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >bar_length = [1; 1]; </span><span style="color: rgb(0, 128, 19);">%Length of bar in m</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >center_of_mass  = [0.45; 0.45];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >moment_of_inertia = [0.084; 0.084];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >initial_parameters = [30; 0; 45; 0]; </span><span style="color: rgb(0, 128, 19);">% Initial degree (theta1, theta_dot_1, theta2, theta_dot_2) parameters of bar</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >initial_parameters = [deg2rad(initial_parameters(1,1)); deg2rad(initial_parameters(2,1)); deg2rad(initial_parameters(3,1)); deg2rad(initial_parameters(4,1))]; </span><span style="color: rgb(0, 128, 19);">% Initial degree (thetha, thetha_dot) parameters of bar</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >applied_torque = [0; 0]; </span><span style="color: rgb(0, 128, 19);">% Applied torque to the bar (T)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% where T is applied wrt to +ve x axis</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >gravitational_acceleration = 9.81; </span><span style="color: rgb(0, 128, 19);">%m/s2</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >graph_time = 10; </span><span style="color: rgb(0, 128, 19);">% Time frame for plotting</span></span></div></div></div><h2  class = 'S5'><span>Symbolic Definition</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >syms </span><span style="color: rgb(167, 9, 245);">g m1 m2 h1 h2 v1 v2 I1 I2 w1 w2 l1 l2 r1 r2 x1(t) x2(t) y1(t) y2(t) theta1(t) theta2(t) T1 T2 'real' </span><span style="color: rgb(0, 128, 19);">% Creating Symbolic Variables</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >sympref(</span><span style="color: rgb(167, 9, 245);">'AbbreviateOutput'</span><span >,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >sympref(</span><span style="color: rgb(167, 9, 245);">'MatrixWithSquareBrackets'</span><span >,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >sympref(</span><span style="color: rgb(167, 9, 245);">'PolynomialDisplayStyle'</span><span >,</span><span style="color: rgb(167, 9, 245);">'ascend'</span><span >);</span></span></div></div></div><h2  class = 'S5'><span>Define Generalised Coordinates</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >q = sym(</span><span style="color: rgb(167, 9, 245);">'q'</span><span >,[2,1]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >q(1) = theta1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >q(2) = theta2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >q</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >dq = diff(q,t)</span></span></div></div></div><h2  class = 'S5'><span>Defining Generalised Inputs</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >u = sym(</span><span style="color: rgb(167, 9, 245);">'u'</span><span >,[2,1]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >u(1) = T1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >u(2) = T2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >u</span></span></div></div></div><h2  class = 'S5'><span>Derive Lagrangian Function</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >PE = m1*g*h1 + m2*g*h2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >PE = subs(PE,[h1, h2],[r1*cos(theta1), l1*cos(theta1) + r2*cos(theta1 + theta2)]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >KE = (m1*(v1^2)/2) + (I1*(w1^2)/2) + (m2*(v2^2)/2) + (I2*(w2^2)/2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >KE = subs(KE,[v1, v2],[sqrt(diff(x1,t)^2 + diff(y1,t)^2), sqrt(diff(x2,t)^2 + diff(y2,t)^2)]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >KE = subs(KE,[x1,y1,w1,x2,y2,w2],[r1*sin(theta1), r1*cos(theta1), diff(theta1,t), l1*sin(theta1) + r2*sin(theta1 + theta2), l1*cos(theta1) + r2*cos(theta1 + theta2),diff(theta1 + theta2,t)]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >LE = KE - PE;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >LE = simplify(LE)</span></span></div></div></div><h2  class = 'S5'><span>Derive Euler Lagrangian Equations</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >EL_eq = simplify(diff(jacobian(LE,dq),t) - jacobian(LE,q) - u')</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >syms </span><span style="color: rgb(167, 9, 245);">thethaddot1 thethaddot2 'real'</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >EL_eq = subs(EL_eq,[diff(theta1,t,2), diff(theta2,t,2)],[thethaddot1, thethaddot2]);</span></span></div></div></div><h2  class = 'S5'><span>Symbolic Solution to EL Equation</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >[thethaddot1, thethaddot2]=solve([EL_eq(1,1), EL_eq(1,2)],[thethaddot1, thethaddot2]);</span></span></div></div></div><h2  class = 'S5'><span>Defining State Space Matrix</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >syms </span><span style="color: rgb(167, 9, 245);">z1 z2 z3 z4 'real'</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >z = [z1;z2;z3;z4];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >dz = [z2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    thethaddot1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    z4;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    thethaddot2</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    ];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >dz = simplify(dz);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >dz = subs(dz,[diff(theta1,t),diff(theta2,t)],[z2,z4]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >dz = subs(dz,[theta1,theta2],[z1,z3])</span></span></div></div></div><h2  class = 'S5'><span>(a): Finding Equilibirium Points</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >dz_eq = simplify(subs(dz,[g, T1, m1, l1, r1, I1, T2, m2, l2, r2, I2,z2,z4],[gravitational_acceleration, applied_torque(1,1), bar_mass(1,1), bar_length(1,1), center_of_mass(1,1), moment_of_inertia(1,1), applied_torque(2,1), bar_mass(2,1), bar_length(2,1), center_of_mass(2,1), moment_of_inertia(2,1),0,0]));</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >[x_star_1, x_star_3] = solve([dz_eq(2,1), dz_eq(4,1)],[z1,z3],</span><span style="color: rgb(167, 9, 245);">'Real'</span><span >,true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >x_eq = [x_star_1(1,1) x_star_1(2,1) x_star_1(3,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    0 0 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    x_star_3(1,1) x_star_3(2,1) x_star_3(3,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    0 0 0;]</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >x_star = x_eq(:,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >u_star = [0;0]</span></span></div></div></div><h2  class = 'S5'><span>(b): Linearization of dx about Equilibirium Points</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >syms </span><span style="color: rgb(167, 9, 245);">x1(t) x2(t) x3(t) x4(t)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >x = [x1;x2;x3;x4];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >x_bar = x - x_star</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >u_bar = u - u_star</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >linear_A = jacobian(dz,z);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >linear_B = jacobian(dz,u);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >linear_A = double(subs(subs(linear_A,[z1,z2,z3,z4],[x_star(1,1),x_star(2,1),x_star(3,1),x_star(4,1)]),[g, T1, m1, l1, r1, I1, T2, m2, l2, r2, I2],[gravitational_acceleration, applied_torque(1,1), bar_mass(1,1), bar_length(1,1), center_of_mass(1,1), moment_of_inertia(1,1), applied_torque(2,1), bar_mass(2,1), bar_length(2,1), center_of_mass(2,1), moment_of_inertia(2,1)]))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >linear_B = double(subs(subs(linear_B,[z1,z2,z3,z4],[x_star(1,1),x_star(2,1),x_star(3,1),x_star(4,1)]),[g, T1, m1, l1, r1, I1, T2, m2, l2, r2, I2],[gravitational_acceleration, applied_torque(1,1), bar_mass(1,1), bar_length(1,1), center_of_mass(1,1), moment_of_inertia(1,1), applied_torque(2,1), bar_mass(2,1), bar_length(2,1), center_of_mass(2,1), moment_of_inertia(2,1)]))</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >dx_bar = linear_A*x_bar + linear_B*u_bar</span></span></div></div></div><h2  class = 'S5'><span>(c): Finding if the linearized system is stable of not</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >lambda = double(eig(linear_A))</span><span style="color: rgb(0, 128, 19);">% Eigen Values</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >system_stability = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >number_of_lamba = size(lambda);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:1:number_of_lamba(1,1)</span><span style="color: rgb(0, 128, 19);">% Loop to check all lambda values</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if</span><span >(real(lambda(i,1))&gt;0)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >        system_stability = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if</span><span >(system_stability==1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    disp(</span><span style="color: rgb(167, 9, 245);">"System is stable"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    disp(</span><span style="color: rgb(167, 9, 245);">"System is unstable"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S5'><span>(d): Finding if the linearized system is controllable or not</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >C = ctrb(linear_A,linear_B)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if</span><span >(rank(C) == rank(linear_A))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    disp(</span><span style="color: rgb(167, 9, 245);">"System is controllable"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    disp(</span><span style="color: rgb(167, 9, 245);">"System is uncontrollable"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S5'><span>(e): Design State Feedback Controller</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >poles = [-1, -2,-1-1j, -1+1j]</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >K = place(linear_A,linear_B,poles)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >A_SF = linear_A - (linear_B*K)</span></span></div></div></div><h2  class = 'S5'><span>(f): Solving Differential Equation to get thetha</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%Converting dx from symbolic to function</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >dx_sf = A_SF*x_bar</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >vars = [x1(t) x2(t) x3(t) x4(t)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >function_converter = odeFunction(dx_sf, vars); </span><span style="color: rgb(0, 128, 19);">% Converts symbolic function in Function</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >func_dx = @(t,x)function_converter(t,x);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >tspan =[0 graph_time];</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >[t,state_space_matrix] = ode45(func_dx,tspan,initial_parameters);</span></span></div></div></div><h2  class = 'S5'><span>(f.a): Constraining inputs</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >r_size = size(t);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >r_size = r_size(1,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >input_torque = zeros(r_size,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >system_input1_in_range = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >system_input2_in_range = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:1:r_size</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    X = state_space_matrix(i,:)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    Z = -K*X;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    input_torque(i,1) = Z(1,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    input_torque(i,2) = Z(2,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if</span><span >(input_torque(i,1)&gt;20 || input_torque(i,1)&lt;-20)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >        system_input1_in_range = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if</span><span >(input_torque(i,2)&gt;10 || input_torque(i,2)&lt;-10)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >        system_input2_in_range = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if</span><span >(system_input1_in_range==0)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    disp(</span><span style="color: rgb(167, 9, 245);">"Torque 1 out of bounds, redesign system"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    T1_max = max(input_torque(:,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    T1_min = min(input_torque(:,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if</span><span >(system_input2_in_range==0)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    disp(</span><span style="color: rgb(167, 9, 245);">"Torque 2 out of bounds, redesign system"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    T2_max = max(input_torque(:,2))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    T2_min = min(input_torque(:,2))</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S5'><span>Calculating Link Positions</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >position = zeros(r_size(1,1),4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i = 1:r_size(1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    position(i,1) = bar_length(1,1)*sin(state_space_matrix(i,1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    position(i,2) = bar_length(1,1)*cos(state_space_matrix(i,1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    position(i,3) = position(i,1) + bar_length(2,1)*sin(state_space_matrix(i,1) + state_space_matrix(i,3));</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    position(i,4) = position(i,2) + bar_length(2,1)*cos(state_space_matrix(i,1) + state_space_matrix(i,3));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S5'><span>Animation</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >xAxisArrayXCoordinates = [-2 2];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xAxisArrayYCoordinates = [0 0];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >yAxisArrayXCoordinates = [0 0];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >yAxisArrayYCoordinates = [-2 2];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >th = 0:pi/50:2*pi;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xunit = (bar_length(1,1) + bar_length(2,1)) * cos(th);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >yunit = (bar_length(1,1) + bar_length(2,1)) * sin(th);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plot(t,state_space_matrix(:,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'t'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'${\theta_1}$'</span><span >, </span><span style="color: rgb(167, 9, 245);">'Interpreter'</span><span >,</span><span style="color: rgb(167, 9, 245);">'latex'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >saveas(gcf,</span><span style="color: rgb(167, 9, 245);">'theta1.jpg'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plot(t,state_space_matrix(:,2))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'t'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'$\dot{\theta_1}$'</span><span >, </span><span style="color: rgb(167, 9, 245);">'Interpreter'</span><span >,</span><span style="color: rgb(167, 9, 245);">'latex'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >saveas(gcf,</span><span style="color: rgb(167, 9, 245);">'theta_dot_1.jpg'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plot(t,input_torque(:,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'t'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'${\tau_1}$'</span><span >, </span><span style="color: rgb(167, 9, 245);">'Interpreter'</span><span >,</span><span style="color: rgb(167, 9, 245);">'latex'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >saveas(gcf,</span><span style="color: rgb(167, 9, 245);">'tau_1.jpg'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plot(t,state_space_matrix(:,3))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'t'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'${\theta_2}$'</span><span >, </span><span style="color: rgb(167, 9, 245);">'Interpreter'</span><span >,</span><span style="color: rgb(167, 9, 245);">'latex'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >saveas(gcf,</span><span style="color: rgb(167, 9, 245);">'theta2.jpg'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plot(t,state_space_matrix(:,4))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'t'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'$\dot{\theta_2}$'</span><span >, </span><span style="color: rgb(167, 9, 245);">'Interpreter'</span><span >,</span><span style="color: rgb(167, 9, 245);">'latex'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >saveas(gcf,</span><span style="color: rgb(167, 9, 245);">'theta_dot_2.jpg'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >plot(t,input_torque(:,2))</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'t'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'${\tau_2}$'</span><span >, </span><span style="color: rgb(167, 9, 245);">'Interpreter'</span><span >,</span><span style="color: rgb(167, 9, 245);">'latex'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >saveas(gcf,</span><span style="color: rgb(167, 9, 245);">'tau_2.jpg'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >delete(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation.avi'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >animation = VideoWriter(</span><span style="color: rgb(167, 9, 245);">'MATLAB Simulation.avi'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >open(animation);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i = 1:1:r_size(1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">%Plotting Graph</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    link1XCoordinates = [0 position(i,1)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    link1YCoordinates = [0 position(i,2)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    link2XCoordinates = [position(i,1) position(i,3)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    link2YCoordinates = [position(i,2) position(i,4)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    plot(xunit, yunit,</span><span style="color: rgb(167, 9, 245);">'k'</span><span >,</span><span style="color: rgb(167, 9, 245);">'LineStyle'</span><span >,</span><span style="color: rgb(167, 9, 245);">'--'</span><span >); </span><span style="color: rgb(0, 128, 19);">% Draw Circular Axes</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    hold </span><span style="color: rgb(167, 9, 245);">on</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    plot(link1XCoordinates, link1YCoordinates, </span><span style="color: rgb(167, 9, 245);">'red'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    plot(link2XCoordinates, link2YCoordinates, </span><span style="color: rgb(167, 9, 245);">'blue'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    frame = getframe(gcf);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    writeVideo(animation,frame);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    pause(0.1); </span><span style="color: rgb(0, 128, 19);">% pause to see realtime animation. Given in seconds</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    hold </span><span style="color: rgb(167, 9, 245);">off</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >close(animation);</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Two-Link Planar Robot Manipulator with Distributed Mass
%% Clear all data

clc;
clear all;
close all;
clf; %Clear all figures
%% Basic Definition

bar_mass = [1; 1]; % mass of bar in kg
bar_length = [1; 1]; %Length of bar in m
center_of_mass  = [0.45; 0.45];
moment_of_inertia = [0.084; 0.084];
initial_parameters = [30; 0; 45; 0]; % Initial degree (theta1, theta_dot_1, theta2, theta_dot_2) parameters of bar
initial_parameters = [deg2rad(initial_parameters(1,1)); deg2rad(initial_parameters(2,1)); deg2rad(initial_parameters(3,1)); deg2rad(initial_parameters(4,1))]; % Initial degree (thetha, thetha_dot) parameters of bar
applied_torque = [0; 0]; % Applied torque to the bar (T)
% where T is applied wrt to +ve x axis
gravitational_acceleration = 9.81; %m/s2
graph_time = 10; % Time frame for plotting
%% Symbolic Definition

syms g m1 m2 h1 h2 v1 v2 I1 I2 w1 w2 l1 l2 r1 r2 x1(t) x2(t) y1(t) y2(t) theta1(t) theta2(t) T1 T2 'real' % Creating Symbolic Variables
sympref('AbbreviateOutput',false);
sympref('MatrixWithSquareBrackets',true);
sympref('PolynomialDisplayStyle','ascend');
%% Define Generalised Coordinates

q = sym('q',[2,1]);
q(1) = theta1;
q(2) = theta2;
q
dq = diff(q,t)
%% Defining Generalised Inputs

u = sym('u',[2,1]);
u(1) = T1;
u(2) = T2;
u
%% Derive Lagrangian Function

PE = m1*g*h1 + m2*g*h2;
PE = subs(PE,[h1, h2],[r1*cos(theta1), l1*cos(theta1) + r2*cos(theta1 + theta2)]);
KE = (m1*(v1^2)/2) + (I1*(w1^2)/2) + (m2*(v2^2)/2) + (I2*(w2^2)/2);
KE = subs(KE,[v1, v2],[sqrt(diff(x1,t)^2 + diff(y1,t)^2), sqrt(diff(x2,t)^2 + diff(y2,t)^2)]);
KE = subs(KE,[x1,y1,w1,x2,y2,w2],[r1*sin(theta1), r1*cos(theta1), diff(theta1,t), l1*sin(theta1) + r2*sin(theta1 + theta2), l1*cos(theta1) + r2*cos(theta1 + theta2),diff(theta1 + theta2,t)]);
LE = KE - PE;
LE = simplify(LE)
%% Derive Euler Lagrangian Equations

EL_eq = simplify(diff(jacobian(LE,dq),t) - jacobian(LE,q) - u')
syms thethaddot1 thethaddot2 'real'
EL_eq = subs(EL_eq,[diff(theta1,t,2), diff(theta2,t,2)],[thethaddot1, thethaddot2]);
%% Symbolic Solution to EL Equation

[thethaddot1, thethaddot2]=solve([EL_eq(1,1), EL_eq(1,2)],[thethaddot1, thethaddot2]);
%% Defining State Space Matrix

syms z1 z2 z3 z4 'real'
z = [z1;z2;z3;z4];
dz = [z2;
    thethaddot1;
    z4;
    thethaddot2
    ];
dz = simplify(dz);
dz = subs(dz,[diff(theta1,t),diff(theta2,t)],[z2,z4]);
dz = subs(dz,[theta1,theta2],[z1,z3])
%% (a): Finding Equilibirium Points

dz_eq = simplify(subs(dz,[g, T1, m1, l1, r1, I1, T2, m2, l2, r2, I2,z2,z4],[gravitational_acceleration, applied_torque(1,1), bar_mass(1,1), bar_length(1,1), center_of_mass(1,1), moment_of_inertia(1,1), applied_torque(2,1), bar_mass(2,1), bar_length(2,1), center_of_mass(2,1), moment_of_inertia(2,1),0,0]));
[x_star_1, x_star_3] = solve([dz_eq(2,1), dz_eq(4,1)],[z1,z3],'Real',true);
x_eq = [x_star_1(1,1) x_star_1(2,1) x_star_1(3,1);
    0 0 0;
    x_star_3(1,1) x_star_3(2,1) x_star_3(3,1);
    0 0 0;]
x_star = x_eq(:,1)
u_star = [0;0]
%% (b): Linearization of dx about Equilibirium Points

syms x1(t) x2(t) x3(t) x4(t)
x = [x1;x2;x3;x4];
x_bar = x - x_star
u_bar = u - u_star
linear_A = jacobian(dz,z);
linear_B = jacobian(dz,u);
linear_A = double(subs(subs(linear_A,[z1,z2,z3,z4],[x_star(1,1),x_star(2,1),x_star(3,1),x_star(4,1)]),[g, T1, m1, l1, r1, I1, T2, m2, l2, r2, I2],[gravitational_acceleration, applied_torque(1,1), bar_mass(1,1), bar_length(1,1), center_of_mass(1,1), moment_of_inertia(1,1), applied_torque(2,1), bar_mass(2,1), bar_length(2,1), center_of_mass(2,1), moment_of_inertia(2,1)]))
linear_B = double(subs(subs(linear_B,[z1,z2,z3,z4],[x_star(1,1),x_star(2,1),x_star(3,1),x_star(4,1)]),[g, T1, m1, l1, r1, I1, T2, m2, l2, r2, I2],[gravitational_acceleration, applied_torque(1,1), bar_mass(1,1), bar_length(1,1), center_of_mass(1,1), moment_of_inertia(1,1), applied_torque(2,1), bar_mass(2,1), bar_length(2,1), center_of_mass(2,1), moment_of_inertia(2,1)]))
dx_bar = linear_A*x_bar + linear_B*u_bar
%% (c): Finding if the linearized system is stable of not

lambda = double(eig(linear_A))% Eigen Values
system_stability = 1;
number_of_lamba = size(lambda);
for i=1:1:number_of_lamba(1,1)% Loop to check all lambda values
    if(real(lambda(i,1))>0)
        system_stability = 0;
    end
end
if(system_stability==1)
    disp("System is stable")
else
    disp("System is unstable")
end
%% (d): Finding if the linearized system is controllable or not

C = ctrb(linear_A,linear_B)
if(rank(C) == rank(linear_A))
    disp("System is controllable")
else
    disp("System is uncontrollable")
end
%% (e): Design State Feedback Controller

poles = [-1, -2,-1-1j, -1+1j]
K = place(linear_A,linear_B,poles)
A_SF = linear_A - (linear_B*K)
%% (f): Solving Differential Equation to get thetha

%Converting dx from symbolic to function
dx_sf = A_SF*x_bar
vars = [x1(t) x2(t) x3(t) x4(t)];
function_converter = odeFunction(dx_sf, vars); % Converts symbolic function in Function
func_dx = @(t,x)function_converter(t,x);
tspan =[0 graph_time];
[t,state_space_matrix] = ode45(func_dx,tspan,initial_parameters);
%% (f.a): Constraining inputs

r_size = size(t);
r_size = r_size(1,1);
input_torque = zeros(r_size,2);
system_input1_in_range = 1;
system_input2_in_range = 1;
for i=1:1:r_size
    X = state_space_matrix(i,:)';
    Z = -K*X;
    input_torque(i,1) = Z(1,1);
    input_torque(i,2) = Z(2,1);
    if(input_torque(i,1)>20 || input_torque(i,1)<-20)
        system_input1_in_range = 0;
    end
    if(input_torque(i,2)>10 || input_torque(i,2)<-10)
        system_input2_in_range = 0;
    end
end
if(system_input1_in_range==0)
    disp("Torque 1 out of bounds, redesign system")
    T1_max = max(input_torque(:,1))
    T1_min = min(input_torque(:,1))
end
if(system_input2_in_range==0)
    disp("Torque 2 out of bounds, redesign system")
    T2_max = max(input_torque(:,2))
    T2_min = min(input_torque(:,2))
end
%% Calculating Link Positions

position = zeros(r_size(1,1),4);
for i = 1:r_size(1,1)
    position(i,1) = bar_length(1,1)*sin(state_space_matrix(i,1));
    position(i,2) = bar_length(1,1)*cos(state_space_matrix(i,1));
    position(i,3) = position(i,1) + bar_length(2,1)*sin(state_space_matrix(i,1) + state_space_matrix(i,3));
    position(i,4) = position(i,2) + bar_length(2,1)*cos(state_space_matrix(i,1) + state_space_matrix(i,3));
end
%% Animation

xAxisArrayXCoordinates = [-2 2];
xAxisArrayYCoordinates = [0 0];
yAxisArrayXCoordinates = [0 0];
yAxisArrayYCoordinates = [-2 2];
th = 0:pi/50:2*pi;
xunit = (bar_length(1,1) + bar_length(2,1)) * cos(th);
yunit = (bar_length(1,1) + bar_length(2,1)) * sin(th);
plot(t,state_space_matrix(:,1))
xlabel('t')
ylabel('${\theta_1}$', 'Interpreter','latex')
title('MATLAB Simulation')
saveas(gcf,'theta1.jpg')
plot(t,state_space_matrix(:,2))
xlabel('t')
ylabel('$\dot{\theta_1}$', 'Interpreter','latex')
title('MATLAB Simulation')
saveas(gcf,'theta_dot_1.jpg')
plot(t,input_torque(:,1))
xlabel('t')
ylabel('${\tau_1}$', 'Interpreter','latex')
title('MATLAB Simulation')
saveas(gcf,'tau_1.jpg')
plot(t,state_space_matrix(:,3))
xlabel('t')
ylabel('${\theta_2}$', 'Interpreter','latex')
title('MATLAB Simulation')
saveas(gcf,'theta2.jpg')
plot(t,state_space_matrix(:,4))
xlabel('t')
ylabel('$\dot{\theta_2}$', 'Interpreter','latex')
title('MATLAB Simulation')
saveas(gcf,'theta_dot_2.jpg')
plot(t,input_torque(:,2))
xlabel('t')
ylabel('${\tau_2}$', 'Interpreter','latex')
title('MATLAB Simulation')
saveas(gcf,'tau_2.jpg')
delete('MATLAB Simulation.avi');
animation = VideoWriter('MATLAB Simulation.avi');
open(animation);
for i = 1:1:r_size(1,1)
    %Plotting Graph
    link1XCoordinates = [0 position(i,1)];
    link1YCoordinates = [0 position(i,2)];
    link2XCoordinates = [position(i,1) position(i,3)];
    link2YCoordinates = [position(i,2) position(i,4)];
    plot(xunit, yunit,'k','LineStyle','REPLACE_WITH_DASH_DASH'); % Draw Circular Axes
    hold on;
    plot(link1XCoordinates, link1YCoordinates, 'red');
    plot(link2XCoordinates, link2YCoordinates, 'blue');
    frame = getframe(gcf);
    writeVideo(animation,frame);
    pause(0.1); % pause to see realtime animation. Given in seconds
    hold off;
end
close(animation);
##### SOURCE END #####
-->
</div></body></html>